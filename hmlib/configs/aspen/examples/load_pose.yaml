minimal_context: true

trunks:
  image_prep:
    class: hmlib.aspen.trunks.image_prep.ImagePrepTrunk
    depends: []
    params: {}

  detector_factory:
    class: hmlib.aspen.trunks.detector_factory.DetectorFactoryTrunk
    depends: []
    params:
      detector_yaml: hmlib/configs/aspen/models/bytetrack_yolox_s.detector.yaml
      data_preprocessor:
        type: TrackDataPreprocessor
        pad_size_divisor: 32
        use_det_processor: true

  detector:
    class: hmlib.aspen.trunks.detector.DetectorInferenceTrunk
    depends: [image_prep, detector_factory]
    params: {}

  tracker:
    class: hmlib.aspen.trunks.tracker.TrackerTrunk
    depends: [detector]
    params: {}

  # Replace pose inferencer with a dataframe-backed loader
  load_pose:
    class: hmlib.aspen.trunks.load.LoadPoseTrunk
    depends: [tracker]
    params: {}

  # Optional saver for pose results
  save_pose:
    class: hmlib.aspen.trunks.save.SavePoseTrunk
    depends: [load_pose]
    params: {}

  postprocess:
    class: hmlib.aspen.trunks.postprocess.CamPostProcessTrunk
    depends: [load_pose]
    params: {}


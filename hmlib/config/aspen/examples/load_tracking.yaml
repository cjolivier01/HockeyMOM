aspen:
  minimal_context: true

  trunks:
    image_prep:
      class: hmlib.aspen.trunks.image_prep.ImagePrepTrunk
      depends: []
      params: {}

    detector_factory:
      class: hmlib.aspen.trunks.detector_factory.DetectorFactoryTrunk
      depends: []
      params:
      detector_yaml: hmlib/config/aspen/models/bytetrack_yolox_s.detector.yaml
        data_preprocessor:
          type: TrackDataPreprocessor
          pad_size_divisor: 32
          use_det_processor: true

    detector:
      class: hmlib.aspen.trunks.detector.DetectorInferenceTrunk
      depends: [image_prep, detector_factory]
      params: {}

    # Save detections after detector, if desired
    save_detections:
      class: hmlib.aspen.trunks.save.SaveDetectionsTrunk
      depends: [detector]
      params: {}

    # Replace tracker with a dataframe-backed loader
    load_tracking:
      class: hmlib.aspen.trunks.load.LoadTrackingTrunk
      depends: [detector]
      params: {}

    # Optional: also save tracking if dynamically produced elsewhere
    save_tracking:
      class: hmlib.aspen.trunks.save.SaveTrackingTrunk
      depends: [load_tracking]
      params: {}

    pose:
      class: hmlib.aspen.trunks.pose.PoseTrunk
      depends: [load_tracking]
      params: {}

    postprocess:
      class: hmlib.aspen.trunks.postprocess.CamPostProcessTrunk
      depends: [pose]
      params: {}

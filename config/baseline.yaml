#
# Camera type
#
camera:
  name: "GoPro"
  make: null
  model: null
  output-fps: null
  mount:
    - offset_80:
      resolution: null
    - offset_90:
      resolution: null

#
# Rink config
#
rink:
  name: null
  location:
    city: null
    state: null
    country: null
  dimensions:
    length: null
    width: null
    corner_radius: null
  surface_type: "Ice"
  seating_capacity: null
  teams:
    home_team:
      name: null
      colors: null
  facilities:
    locker_rooms: null
    concession_stands: null
    restrooms: null
  parking:
    capacity: null
    price: null
  scoreboard:
    # 4-sided polygon that maps out the scoreboard in the perspective view
    # Should be tlbr form, with values: [x, y]
    perspective_polygon: null
    projected_height: 500
    projected_width: 500
  end_zones:
    #
    # End zone start/stop thresholds (lines of the form (x1, y1), (x2, y2))
    #
    # Where we switch to end-zone view on the ldft
    left_start: null
    # Were we switch back to pan view on the lft
    left_stop: null
    # Where we switch to end-zone view on the ldft
    right_start: null
    # Were we switch back to pan view on the lft
    right_stop: null


  tracking:
    #
    # Some tracking config
    #
    cam_ignore_largest: true
  camera:
    #
    # Rink-related tracking config
    #
    fixed_edge_scaling_factor: 0.8
    fixed_edge_rotation_angle: 30
    image_channel_adjustment: null
    follower_box_scale_width: 1.25
    follower_box_scale_height: 1.25

    # Sticky translation
    sticky_size_ratio_to_frame_width: 10.0
    sticky_translation_gaussian_mult: 5.0
    unsticky_translation_size_ratio: 0.75

    #
    # Configuration for breakaways
    #
    breakaway_detection:
      # Group velocities less than this are ignored
      min_considered_group_velocity: 3.0
      # What ratio of tracked players must be all reacting
      # to a breakaway?
      group_ratio_threshold: 0.5
      # What ratio of the group speed should we try to
      # apply within a single frame's speed adjustment?
      group_velocity_speed_ratio: 0.3
      # During a breakaway, what scale do we adjust the
      # maximum camera speed to allow for faster-than-normal tracking?
      scale_speed_constraints: 2.0
      # The number of frame steps to not allow any camera-stop conditions to
      # trigger such as cluster(s) direction change or "sticky translation" rules.
      # This is because the clusters may not have changed enough at the
      # beginning of a breakaway and may simply stop the camera movement
      # due to the cluster tracking rules.
      nonstop_delay_count: 2
      # When over-shooting the breakaway players, what scale do we apply
      # to the current speed each frame in order to slow it down?
      overshoot_scale_speed_ratio: 0.7

#
# Game config
#
game:
  name: null
  rink: null
  home: null
  away: null

  stitching:
    frame_offsets:
      left: null
      right: null
    control_points:
      m_kpts0: null
      m_kpts1: null

    offsets: null

  clip_box: null
  boundaries:
    upper:
    upper_tune_position: null
    lower:
    lower_tune_position: null
    # For scaling to a new stitched size
    scale_width: null
    scale_height: null


#
# Model config
#
model:
  end_to_end:
    # config: config/models/hm/hm_end_to_end.py
    # checkpoint: pretrained/mmdetection/yolox_s_8x8_300e_coco_80e_ch.pth
    
    # mmv2 checkpoitn with "detector." prefix
    config: config/models/hm2/hm_end_to_end.py
    checkpoint: pretrained/mmdetection/yolox_s_8x8_300e_coco_80e_ch_with_detector_prefix.pth

  pose:
    config: openmm/mmpose/configs/wholebody/2d_kpt_sview_rgb_img/topdown_heatmap/coco-wholebody/hrnet_w48_coco_wholebody_384x288_dark_plus.py
    checkpoint: https://download.openmmlab.com/mmpose/top_down/hrnet/hrnet_w48_coco_wholebody_384x288_dark-f5726563_20200918.pth

  ice_rink_segm:
    config: config/models/ice_rink/mask2former_swin-s-p4-w7-224_lsj_8x2_50e_coco.py
    checkpoint: pretrained/mask2former_swin-s-p4-w7-224_lsj_8x2_50e_coco/ice_rink_iter_19500.pth

  svnh_classifier:
    config: null
    checkpoint: pretrained/svhnc/model-65000.pth

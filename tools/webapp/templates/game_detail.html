{% extends "layout.html" %}
{% block content %}
<div class="card">
  <h2 style="margin:0 0 .25rem">{{ game.name }}</h2>
  <p class="muted" style="margin:.25rem 0 .75rem"><small>Directory:</small> <code>{{ game.dir_path }}</code></p>
  {% with st=status|default:game.status %}
<p>Status: <span class="status-badge status-{{ st|default_if_none:""|upper }}">{{ st|default_if_none:"" }}</span></p>
  {% endwith %}
</div>

<h3>Upload Files</h3>
{% if not is_locked %}
<form method="post" action="/games/{{ game.id }}/upload" enctype="multipart/form-data">
  {% csrf_token %}
  <input type="file" name="files" multiple>
  <button type="submit">Upload</button>
</form>
{% else %}
<p>Uploads disabled after job submission/completion.</p>
{% endif %}

<h3>Files</h3>
<div class="card">
  <ul>
    {% for f in files %}
      <li>{{ f }}</li>
    {% empty %}
      <li class="muted">No files yet.</li>
    {% endfor %}
  </ul>
</div>

{% if not is_locked %}
<form method="post" action="/games/{{ game.id }}/run">
  {% csrf_token %}
  <button type="submit">Run</button>
</form>
{% else %}
<p>Run disabled: job already submitted or finished.</p>
{% endif %}

<p><a class="btn" href="/games">Back</a></p>
<div class="spacer"></div>
<div class="card">
  <h3>Danger Zone</h3>
  <p class="muted">Permanently delete this game and its files. This cannot be undone.</p>
  <p><a class="btn danger" href="/games/{{ game.id }}/delete">Delete game</a></p>
</div>
{% endblock %}
